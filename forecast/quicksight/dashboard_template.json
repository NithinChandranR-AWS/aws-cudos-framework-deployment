{
  "Version": "2020-09-30",
  "SheetId": "cost-forecast-overview",
  "Layouts": [
    {
      "Configuration": {
        "GridLayout": {
          "Elements": [
            {
              "ElementId": "forecast-trend-chart",
              "ElementType": "VISUAL",
              "ColumnIndex": 0,
              "ColumnSpan": 8,
              "RowIndex": 0,
              "RowSpan": 6
            },
            {
              "ElementId": "forecast-kpi-cards",
              "ElementType": "VISUAL",
              "ColumnIndex": 8,
              "ColumnSpan": 4,
              "RowIndex": 0,
              "RowSpan": 2
            },
            {
              "ElementId": "forecast-by-service",
              "ElementType": "VISUAL",
              "ColumnIndex": 8,
              "ColumnSpan": 4,
              "RowIndex": 2,
              "RowSpan": 4
            },
            {
              "ElementId": "forecast-details-table",
              "ElementType": "VISUAL",
              "ColumnIndex": 0,
              "ColumnSpan": 12,
              "RowIndex": 6,
              "RowSpan": 6
            }
          ],
          "CanvasSizeOptions": {
            "ScreenCanvasSizeOptions": {
              "ResizeOption": "RESPONSIVE",
              "OptimizedViewPortWidth": "1600px"
            }
          }
        }
      }
    }
  ],
  "ParameterDeclarations": [
    {
      "Name": "DateRangeFilter",
      "DataType": "DATETIME",
      "DefaultValues": {
        "RollingDate": {
          "Expression": "rolling(P3M, startOfMonth)",
          "ExpressionContext": "end"
        }
      },
      "ValueWhenUnset": {
        "RollingDate": {
          "Expression": "rolling(P3M, startOfMonth)",
          "ExpressionContext": "end"
        }
      }
    },
    {
      "Name": "DimensionFilter",
      "DataType": "STRING",
      "DefaultValues": {
        "StaticValues": [
          "SERVICE"
        ]
      },
      "ValueWhenUnset": {
        "StaticValues": [
          "SERVICE"
        ]
      }
    }
  ],
  "FilterGroups": [
    {
      "FilterGroupId": "forecast-filters",
      "Filters": [
        {
          "FilterId": "date-filter",
          "Column": {
            "ColumnName": "start_date",
            "DataSetIdentifier": "cost_forecast_dataset"
          },
          "FilterType": "PARAMETRIC",
          "CustomFilterConfiguration": {
            "ParameterName": "DateRangeFilter"
          }
        },
        {
          "FilterId": "dimension-filter",
          "Column": {
            "ColumnName": "dimension",
            "DataSetIdentifier": "cost_forecast_dataset"
          },
          "FilterType": "PARAMETRIC",
          "CustomFilterConfiguration": {
            "ParameterName": "DimensionFilter"
          }
        }
      ],
      "ScopeConfiguration": {
        "SelectedSheets": {
          "SheetVisualScopingConfigurations": [
            {
              "SheetId": "cost-forecast-overview",
              "Visuals": [
                "forecast-trend-chart",
                "forecast-by-service",
                "forecast-kpi-cards",
                "forecast-details-table"
              ]
            }
          ]
        }
      }
    }
  ],
  "VisualCustomActions": [],
  "Visuals": [
    {
      "LineChartVisual": {
        "VisualId": "forecast-trend-chart",
        "Title": {
          "Visibility": "VISIBLE",
          "FormatText": {
            "PlainText": "Cost Forecast Over Time"
          }
        },
        "Subtitle": {
          "Visibility": "VISIBLE",
          "FormatText": {
            "PlainText": "With confidence intervals"
          }
        },
        "ChartConfiguration": {
          "FieldWells": {
            "LineChartAggregatedFieldWells": {
              "Category": [
                {
                  "CategoricalDimensionField": {
                    "FieldId": "start_date",
                    "Column": {
                      "ColumnName": "start_date",
                      "DataSetIdentifier": "cost_forecast_dataset"
                    }
                  }
                }
              ],
              "Values": [
                {
                  "NumericalMeasureField": {
                    "FieldId": "mean_value",
                    "Column": {
                      "ColumnName": "mean_value",
                      "DataSetIdentifier": "cost_forecast_dataset"
                    },
                    "AggregationFunction": "SUM"
                  }
                },
                {
                  "NumericalMeasureField": {
                    "FieldId": "lower_bound",
                    "Column": {
                      "ColumnName": "lower_bound",
                      "DataSetIdentifier": "cost_forecast_dataset"
                    },
                    "AggregationFunction": "SUM"
                  }
                },
                {
                  "NumericalMeasureField": {
                    "FieldId": "upper_bound",
                    "Column": {
                      "ColumnName": "upper_bound",
                      "DataSetIdentifier": "cost_forecast_dataset"
                    },
                    "AggregationFunction": "SUM"
                  }
                }
              ]
            }
          },
          "SortConfiguration": {
            "CategorySort": [
              {
                "FieldSort": {
                  "FieldId": "start_date",
                  "Direction": "ASCENDING"
                }
              }
            ]
          },
          "Tooltip": {
            "TooltipVisibility": "VISIBLE",
            "SelectedTooltipType": "DETAILED"
          },
          "AxisDisplayOptions": {
            "XAxisDisplayOptions": {
              "TickLabelOptions": {
                "RotationAngle": 0
              }
            }
          },
          "DataLabels": {
            "Visibility": "VISIBLE",
            "MeasureLabelVisibility": "VISIBLE",
            "Overlap": "DISABLE_OVERLAP"
          },
          "Legend": {
            "Visibility": "VISIBLE",
            "Position": "RIGHT",
            "Width": "120px"
          },
          "VisualPalette": {
            "ColorMap": [
              {
                "FieldValue": "mean_value",
                "Color": "#2CA02C"
              },
              {
                "FieldValue": "lower_bound",
                "Color": "#D62728"
              },
              {
                "FieldValue": "upper_bound",
                "Color": "#FF7F0E"
              }
            ]
          }
        },
        "Actions": []
      }
    },
    {
      "PieChartVisual": {
        "VisualId": "forecast-by-service",
        "Title": {
          "Visibility": "VISIBLE",
          "FormatText": {
            "PlainText": "Forecast by Service"
          }
        },
        "ChartConfiguration": {
          "FieldWells": {
            "PieChartAggregatedFieldWells": {
              "Category": [
                {
                  "CategoricalDimensionField": {
                    "FieldId": "value",
                    "Column": {
                      "ColumnName": "value",
                      "DataSetIdentifier": "cost_forecast_dataset"
                    }
                  }
                }
              ],
              "Values": [
                {
                  "NumericalMeasureField": {
                    "FieldId": "mean_value",
                    "Column": {
                      "ColumnName": "mean_value",
                      "DataSetIdentifier": "cost_forecast_dataset"
                    },
                    "AggregationFunction": "SUM"
                  }
                }
              ]
            }
          },
          "SortConfiguration": {
            "CategorySort": [
              {
                "FieldSort": {
                  "FieldId": "mean_value",
                  "Direction": "DESCENDING"
                }
              }
            ],
            "CategoryItemsLimit": {
              "OtherCategories": "INCLUDE"
            }
          },
          "DonutOptions": {
            "ArcOptions": {
              "ArcThickness": "MEDIUM"
            }
          },
          "DataLabels": {
            "Visibility": "VISIBLE",
            "CategoryLabelVisibility": "VISIBLE",
            "MeasureLabelVisibility": "VISIBLE",
            "Position": "OUTSIDE"
          },
          "Legend": {
            "Visibility": "VISIBLE"
          }
        },
        "Actions": []
      }
    },
    {
      "KPIVisual": {
        "VisualId": "forecast-kpi-cards",
        "Title": {
          "Visibility": "VISIBLE",
          "FormatText": {
            "PlainText": "Forecast Summary"
          }
        },
        "ChartConfiguration": {
          "FieldWells": {
            "Values": [
              {
                "NumericalMeasureField": {
                  "FieldId": "mean_value",
                  "Column": {
                    "ColumnName": "mean_value",
                    "DataSetIdentifier": "cost_forecast_dataset"
                  },
                  "AggregationFunction": "SUM"
                }
              }
            ],
            "TargetValues": []
          },
          "SortConfiguration": {},
          "KPIOptions": {
            "PrimaryValueDisplayType": "ACTUAL",
            "PrimaryValueFontConfiguration": {
              "FontSize": {
                "Relative": "MEDIUM"
              }
            }
          }
        },
        "Actions": []
      }
    },
    {
      "TableVisual": {
        "VisualId": "forecast-details-table",
        "Title": {
          "Visibility": "VISIBLE",
          "FormatText": {
            "PlainText": "Forecast Details"
          }
        },
        "ChartConfiguration": {
          "FieldWells": {
            "TableAggregatedFieldWells": {
              "GroupBy": [
                {
                  "CategoricalDimensionField": {
                    "FieldId": "start_date",
                    "Column": {
                      "ColumnName": "start_date",
                      "DataSetIdentifier": "cost_forecast_dataset"
                    }
                  }
                },
                {
                  "CategoricalDimensionField": {
                    "FieldId": "dimension",
                    "Column": {
                      "ColumnName": "dimension",
                      "DataSetIdentifier": "cost_forecast_dataset"
                    }
                  }
                },
                {
                  "CategoricalDimensionField": {
                    "FieldId": "value",
                    "Column": {
                      "ColumnName": "value",
                      "DataSetIdentifier": "cost_forecast_dataset"
                    }
                  }
                }
              ],
              "Values": [
                {
                  "NumericalMeasureField": {
                    "FieldId": "mean_value",
                    "Column": {
                      "ColumnName": "mean_value",
                      "DataSetIdentifier": "cost_forecast_dataset"
                    },
                    "AggregationFunction": "SUM"
                  }
                },
                {
                  "NumericalMeasureField": {
                    "FieldId": "lower_bound",
                    "Column": {
                      "ColumnName": "lower_bound",
                      "DataSetIdentifier": "cost_forecast_dataset"
                    },
                    "AggregationFunction": "SUM"
                  }
                },
                {
                  "NumericalMeasureField": {
                    "FieldId": "upper_bound",
                    "Column": {
                      "ColumnName": "upper_bound",
                      "DataSetIdentifier": "cost_forecast_dataset"
                    },
                    "AggregationFunction": "SUM"
                  }
                },
                {
                  "NumericalMeasureField": {
                    "FieldId": "variance",
                    "Column": {
                      "ColumnName": "variance",
                      "DataSetIdentifier": "cost_forecast_dataset"
                    }
                  }
                }
              ]
            }
          },
          "SortConfiguration": {
            "RowSort": [
              {
                "FieldSort": {
                  "FieldId": "start_date",
                  "Direction": "ASCENDING"
                }
              },
              {
                "FieldSort": {
                  "FieldId": "mean_value",
                  "Direction": "DESCENDING"
                }
              }
            ]
          },
          "TableOptions": {
            "CellStyle": {
              "Height": 25
            },
            "HeaderStyle": {
              "TextWrap": "WRAP"
            }
          }
        },
        "Actions": []
      }
    }
  ],
  "CalculatedFields": [
    {
      "DataSetIdentifier": "cost_forecast_dataset",
      "Name": "variance",
      "Expression": "upper_bound - lower_bound"
    }
  ]
}
